<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.78.2" />
    <meta name="description" content="Gatekeeper&#39;s homepage">
<meta name="author" content="gogatekeeper">

    <link rel="shortcut icon" href="/logo/logo.svg" type="image/x-icon" />

    <title>Configuration Options - Gatekeeper</title>

    
    <link href="/css/nucleus.css?1612416408" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1612416408" rel="stylesheet">
    <link href="/css/hybrid.css?1612416408" rel="stylesheet">
    <link href="/css/featherlight.min.css?1612416408" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1612416408" rel="stylesheet">
    <link href="/css/auto-complete.css?1612416408" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1612416408" rel="stylesheet">
    <link href="/css/theme.css?1612416408" rel="stylesheet">
    <link href="/css/hugo-theme.css?1612416408" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1612416408" rel="stylesheet">
    
    <link href="/css/index.css?1612416408" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1612416408"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/configuration/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/'>
  <img src="/logo/logo.svg" width="200" />
  <div id="logo-text">gatekeeper</div>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1612416408"></script>
<script type="text/javascript" src="/js/auto-complete.js?1612416408"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/gogatekeeper.github.io\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1612416408"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/configuration/" title="Configuration Options" class="dd-item
        parent
        active
        
        ">
      <a href="/configuration/">
          Configuration Options
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/gogatekeeper/gatekeeper"><i class='fab fa-github fa-fw'></i> Github repo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://discord.gg/zRqVXXTMCv"><i class='fab fa-discord fa-fw'></i> Join us on Discord</a>
              </li>
          
              <li>
                  <a class="padding" href="https://www.keycloak.org/documentation"><i class='fas fa-code fa-fw'></i> Keycloak Docs</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/'></a> > Configuration Options
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#access-token-duration"><code>access-token-duration</code></a></li>
    <li><a href="#add-claims"><code>add-claims</code></a></li>
    <li><a href="#base-uri"><code>base-uri</code></a></li>
    <li><a href="#client-id"><code>client-id</code></a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#client-secret"><code>client-secret</code></a></li>
    <li><a href="#content-security-policy"><code>content-security-policy</code></a></li>
    <li><a href="#cookie-access-name"><code>cookie-access-name</code></a></li>
    <li><a href="#cookie-domain"><code>cookie-domain</code></a></li>
    <li><a href="#cookie-refresh-name"><code>cookie-refresh-name</code></a></li>
    <li><a href="#cors-credentials"><code>cors-credentials</code></a></li>
    <li><a href="#cors-exposed-headers"><code>cors-exposed-headers</code></a></li>
    <li><a href="#cors-headers"><code>cors-headers</code></a></li>
    <li><a href="#cors-max-age"><code>cors-max-age</code></a></li>
    <li><a href="#cors-methods"><code>cors-methods</code></a></li>
    <li><a href="#cors-origins"><code>cors-origins</code></a></li>
    <li><a href="#disable-all-logging"><code>disable-all-logging</code></a></li>
    <li><a href="#discovery-url"><code>discovery-url</code></a></li>
    <li><a href="#enable-authorization-cookies"><code>enable-authorization-cookies</code></a></li>
    <li><a href="#enable-authorization-header"><code>enable-authorization-header</code></a></li>
    <li><a href="#enable-compression"><code>enable-compression</code></a></li>
    <li><a href="#enable-default-deny"><code>enable-default-deny</code></a></li>
    <li><a href="#enable-encrypted-token"><code>enable-encrypted-token</code></a></li>
    <li><a href="#enable-forwarding"><code>enable-forwarding</code></a></li>
    <li><a href="#enable-https-redirect"><code>enable-https-redirect</code></a></li>
    <li><a href="#enable-json-logging"><code>enable-json-logging</code></a></li>
    <li><a href="#enable-logging"><code>enable-logging</code></a></li>
    <li><a href="#enable-login-handler"><code>enable-login-handler</code></a></li>
    <li><a href="#enable-logout-redirect"><code>enable-logout-redirect</code></a></li>
    <li><a href="#enable-metrics"><code>enable-metrics</code></a></li>
    <li><a href="#enable-profiling"><code>enable-profiling</code></a></li>
    <li><a href="#enable-refresh-tokens"><code>enable-refresh-tokens</code></a></li>
    <li><a href="#enable-security-filter"><code>enable-security-filter</code></a></li>
    <li><a href="#enable-session-cookies"><code>enable-session-cookies</code></a></li>
    <li><a href="#enable-token-header"><code>enable-token-header</code></a></li>
    <li><a href="#enabled-proxy-protocol"><code>enabled-proxy-protocol</code></a></li>
    <li><a href="#encryption-key"><code>encryption-key</code></a></li>
    <li><a href="#filter-browser-xss"><code>filter-browser-xss</code></a></li>
    <li><a href="#filter-content-nosniff"><code>filter-content-nosniff</code></a></li>
    <li><a href="#filter-frame-deny"><code>filter-frame-deny</code></a></li>
    <li><a href="#forbidden-page"><code>forbidden-page</code></a></li>
    <li><a href="#force-encrypted-cookie"><code>force-encrypted-cookie</code></a></li>
    <li><a href="#forwarding-domains"><code>forwarding-domains</code></a></li>
    <li><a href="#forwarding-password"><code>forwarding-password</code></a></li>
    <li><a href="#forwarding-username"><code>forwarding-username</code></a></li>
    <li><a href="#headers"><code>headers</code></a></li>
    <li><a href="#hostnames"><code>hostnames</code></a></li>
    <li><a href="#http-only-cookie"><code>http-only-cookie</code></a></li>
    <li><a href="#letsencrypt-cache-dir"><code>letsencrypt-cache-dir</code></a></li>
    <li><a href="#listen"><code>listen</code></a></li>
    <li><a href="#listen-http"><code>listen-http</code></a></li>
    <li><a href="#localhost-metrics"><code>localhost-metrics</code></a></li>
    <li><a href="#match-claims"><code>match-claims</code></a></li>
    <li><a href="#max-idle-connections"><code>max-idle-connections</code></a></li>
    <li><a href="#max-idle-connections-per-host"><code>max-idle-connections-per-host</code></a></li>
    <li><a href="#no-redirects"><code>no-redirects</code></a></li>
    <li><a href="#oauth-uri"><code>oauth-uri</code></a></li>
    <li><a href="#oauth-uri-1"><code>oauth-uri</code></a></li>
    <li><a href="#openid-provider-proxy"><code>openid-provider-proxy</code></a></li>
    <li><a href="#openid-provider-timeout"><code>openid-provider-timeout</code></a></li>
    <li><a href="#preserve-host"><code>preserve-host</code></a></li>
    <li><a href="#redirection-url"><code>redirection-url</code></a></li>
    <li><a href="#request-id-header"><code>request-id-header</code></a></li>
    <li><a href="#resources"><code>resources</code></a></li>
    <li><a href="#revocation-url"><code>revocation-url</code></a></li>
    <li><a href="#same-site-cookie"><code>same-site-cookie</code></a></li>
    <li><a href="#scopes"><code>scopes</code></a></li>
    <li><a href="#secure-cookie"><code>secure-cookie</code></a></li>
    <li><a href="#server-idle-timeout"><code>server-idle-timeout</code></a></li>
    <li><a href="#server-read-timeout"><code>server-read-timeout</code></a></li>
    <li><a href="#server-write-timeout"><code>server-write-timeout</code></a></li>
    <li><a href="#sign-in-page"><code>sign-in-page</code></a></li>
    <li><a href="#skip-access-token-clientid-check"><code>skip-access-token-clientid-check</code></a></li>
    <li><a href="#skip-access-token-issuer-check"><code>skip-access-token-issuer-check</code></a></li>
    <li><a href="#skip-openid-provider-tls-verify"><code>skip-openid-provider-tls-verify</code></a></li>
    <li><a href="#skip-token-verification"><code>skip-token-verification</code></a></li>
    <li><a href="#skip-upstream-tls-verify"><code>skip-upstream-tls-verify</code></a></li>
    <li><a href="#store-url"><code>store-url</code></a></li>
    <li><a href="#tags"><code>tags</code></a></li>
    <li><a href="#tls-ca-certificate"><code>tls-ca-certificate</code></a></li>
    <li><a href="#tls-ca-key"><code>tls-ca-key</code></a></li>
    <li><a href="#tls-cert"><code>tls-cert</code></a></li>
    <li><a href="#tls-client-certificate"><code>tls-client-certificate</code></a></li>
    <li><a href="#tls-private-key"><code>tls-private-key</code></a></li>
    <li><a href="#upstream-ca"><code>upstream-ca</code></a></li>
    <li><a href="#upstream-expect-continue-timeout"><code>upstream-expect-continue-timeout</code></a></li>
    <li><a href="#upstream-keepalive-timeout"><code>upstream-keepalive-timeout</code></a></li>
    <li><a href="#upstream-keepalives"><code>upstream-keepalives</code></a></li>
    <li><a href="#upstream-response-header-timeout"><code>upstream-response-header-timeout</code></a></li>
    <li><a href="#upstream-timeout"><code>upstream-timeout</code></a></li>
    <li><a href="#upstream-tls-handshake-timeout"><code>upstream-tls-handshake-timeout</code></a></li>
    <li><a href="#upstream-url"><code>upstream-url</code></a></li>
    <li><a href="#use-letsencrypt"><code>use-letsencrypt</code></a></li>
    <li><a href="#verbose"><code>verbose</code></a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Configuration Options
            </h1>
          

        



	<p>These configuration options can either be defined</p>
<ul>
<li>as a command line parameter (use <code>--kebab-case-config-option</code>)</li>
<li>in a yaml/json file (use <code>kebab-case-keys</code>)</li>
<li>through environment variables (only for those where environment variables are defined below)</li>
</ul>
<p>Options issued at the command line have a higher priority and will override or
merge with options referenced in a config file.</p>
<h2 id="access-token-duration"><code>access-token-duration</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>48h</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: 720 hours (30 days)</li>
<li>Related: -</li>
</ul>
</div>

<p>Defines a default access token lifetime if the expiration was not defined by the authorization server.</p>
<p>The access token expiration is normally read from the refresh token, but if that lifetime is not positive, the configured <code>access-token-duration</code> will be used instead.</p>
<hr>
<h2 id="add-claims"><code>add-claims</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>email</code>, <code>email|Foo-Bar-Email</code></li>
<li>Required: No</li>
<li>Default: No claims added as headers</li>
<li>Related: -</li>
</ul>
</div>

<p>Allows you to inject claims from the token as headers in the upstream request.</p>
<p>For example, to inject the user&rsquo;s <code>email</code>, specify</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">add-claims</span>:
- <span style="color:#ae81ff">email</span>
</code></pre></div><p>If the token contains the <code>email</code> claim, the value of the claim will be
injected as the header <code>X-Auth-Email</code> in the upstream request.</p>
<p>The <code>X-Auth-</code> prefix is automatically added, and the header is also capitalized
and joined with dashes. Any symbols in this list: <code>_$&gt;&lt;[].,+-/'%^&amp;*()!\</code> will
be replaced by dashes (<code>-</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">add-claims</span>:
- <span style="color:#ae81ff">given_name</span>
</code></pre></div><p>The above will inject <code>given_name</code> from the token as the <code>X-Auth-Given-Name</code>
header in the request going upstream.</p>
<p>To control the name of the header, use the pipe (<code>|</code>) character:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">add-claims</span>:
- <span style="color:#ae81ff">`email|Foo-Bar-Email`</span>
</code></pre></div><p>The above will inject <code>email</code> from the token as the <code>Foo-Bar-Email</code> header in
the request going upstream.</p>
<hr>
<h2 id="base-uri"><code>base-uri</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_BASE_URI</code></li>
<li>Example: <code>/base-uri</code></li>
<li>Required: No</li>
<li>Default: <code>&quot;&quot;</code></li>
<li>Related: -</li>
</ul>
</div>

<p><code>base-uri</code> is the the base URI of your app. This is where your app lives at the
domain, so if your domain is <code>https://www.example.com</code> and your app is at the
path <code>https://www.example.com/app</code>, then base URI should be <code>/app</code>.</p>
<p>This is used to</p>
<ul>
<li>build oauth related paths, such as the <code>/logout</code> endpoint</li>
<li>set the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Path_attribute:~:text=Path%20attribute,-The">path for cookies</a>,
which determines which parts of your site the cookie is valid on, which in
turn determines if the user remains authenticated as they visit different
parts of the site</li>
</ul>
<hr>
<h2 id="client-id"><code>client-id</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_CLIENT_ID</code></li>
<li>Example: <code>whoami</code> (refer to <a href="https://github.com/gogatekeeper/demo-docker-compose">demo</a>)</li>
<li>Required: Yes, unless <code>skip-token-verification</code> is set, and gatekeeper is in reverse proxy mode</li>
<li>Default: None</li>
<li>Related: <code>client-secret</code></li>
</ul>
</div>

<p><code>client-id</code> is the Client ID for an OAuth2 client (your app is the OAuth2 client, in
this case).</p>
<h4 id="in-reverse-proxy-mode">In reverse proxy mode</h4>
<p>As part of the OAuth2 authorization code flow, gatekeeper will use <code>client-id</code> and
<code>client-secret</code> to authenticate with the server when it needs to</p>
<ul>
<li>exchange the authorization code for tokens</li>
<li>refresh the access token</li>
</ul>
<p>The client ID and secret are also used to invoke the revocation URL at the
authorization server.</p>
<p>If the login handler is enabled (<code>enable-login-handler</code>), the credentials are
also used to login at the authorization provider using the OAuth2 Resource
Owner Password Credentials flow.</p>
<p><code>client-id</code> is also used to check access tokens to ensure that <code>client-id</code> is
among the audiences in the <code>aud</code> field of the token.</p>
<h4 id="in-forward-signing-proxy-mode">In forward-signing proxy mode</h4>
<p>gatekeeper will use <code>client-id</code> and <code>client-secret</code> to authenticate with
the server to get tokens for outbound requests.</p>
<hr>
<h2 id="client-secret"><code>client-secret</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_CLIENT_SECRET</code></li>
<li>Example: <code>932475b6-9748-41b8-8fd7-c6ce2d845ece</code> (refer to <a href="https://github.com/gogatekeeper/demo-docker-compose">demo</a>)</li>
<li>Required: Yes, unless <code>skip-token-verification</code> is set, and gatekeeper is in reverse proxy mode</li>
<li>Default: None</li>
<li>Related: <code>client-id</code></li>
</ul>
</div>

<p><code>client-secret</code> is the client secret for an OAuth2 client (your app is the
OAuth2 client, in this case). This is used with <code>client-id</code> as a pair of
credentials. See <code>client-id</code> for how this is used.</p>
<hr>
<h2 id="content-security-policy"><code>content-security-policy</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>default-src 'self'</code></li>
<li>Required: No</li>
<li>Default: Unspecified</li>
<li>Related: <code>enable-security-filter</code></li>
</ul>
</div>

<p>This configuration option allows you to specify your Content Security Policy. More information <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">on MDN</a></p>
<p><code>enable-security-filter</code> has to be <code>true</code> to enable this.</p>
<hr>
<h2 id="cookie-access-name"><code>cookie-access-name</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>foobar</code> (any cookie name)</li>
<li>Required: No</li>
<li>Default: <code>kc-access</code></li>
<li>Related: <code>cookie-refresh-name</code></li>
</ul>
</div>

<p>Defines the name of the cookie that gatekeeper will use to store the access token.</p>
<hr>
<h2 id="cookie-domain"><code>cookie-domain</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>foobar.org</code></li>
<li>Required: No</li>
<li>Default: Uses the domain from the <code>Host</code> header</li>
<li>Related: -</li>
</ul>
</div>

<p>Defines the <code>Domain</code> attribute for the cookies stored on the browser.</p>
<p>Since the cookies contain the access and refresh token, this setting determines how much of your domain this sign-in covers.</p>
<p>For example, if <code>Domain</code> is set to <code>foobar.org</code>, when the user visits <code>foobar.org</code> or any of the subdomains <code>baz.foobar.org</code> or <code>quux.foobar.org</code>, the cookies will be sent to gatekeeper and the user will continue to be signed in.</p>
<p>See more information about setting the <code>Domain</code> attribute at <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Define_where_cookies_are_sent">MDN</a></p>
<hr>
<h2 id="cookie-refresh-name"><code>cookie-refresh-name</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>foobar</code> (any cookie name)</li>
<li>Required: No</li>
<li>Default: <code>kc-state</code></li>
<li>Related: <code>cookie-access-name</code></li>
</ul>
</div>

<p>Defines the name of the cookie that gatekeeper will use to store the refresh token.</p>
<hr>
<h2 id="cors-credentials"><code>cors-credentials</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>cors-origins</code>, <code>cors-methods</code>, <code>cors-headers</code>, <code>cors-exposed-headers</code>, <code>cors-max-age</code></li>
</ul>
</div>

<p>If set, gatekeeper will set the <code>Access-Control-Allow-Credentials</code> header with the value <code>true</code>.</p>
<blockquote>
<p><code>cors-origins</code> has to be set before this configuration option takes effect</p>
</blockquote>
<hr>
<h2 id="cors-exposed-headers"><code>cors-exposed-headers</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>X-Foo-Bar</code></li>
<li>Required: No</li>
<li>Default: <code>[]</code></li>
<li>Related: <code>cors-origins</code>, <code>cors-methods</code>, <code>cors-headers</code>, <code>cors-credentials</code>, <code>cors-max-age</code></li>
</ul>
</div>

<p>This is a list of headers that will be added to the <code>Access-Control-Expose-Headers</code> header.</p>
<blockquote>
<p><code>cors-origins</code> has to be set before this configuration option takes effect</p>
</blockquote>
<hr>
<h2 id="cors-headers"><code>cors-headers</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>X-Foo-Bar</code></li>
<li>Required: No</li>
<li>Default: <code>[&quot;Origin&quot;, &quot;Accept&quot;, &quot;Content-Type&quot;, &quot;X-Requested-With&quot;]</code></li>
<li>Related: <code>cors-origins</code>, <code>cors-methods</code>, <code>cors-exposed-headers</code>, <code>cors-credentials</code>, <code>cors-max-age</code></li>
</ul>
</div>

<p>This is a list of allowed headers that will be added to the <code>Access-Control-Allow-Headers</code> header.</p>
<p><code>Origin</code> will always be appended to the requested list.</p>
<blockquote>
<p><code>cors-origins</code> has to be set before this configuration option takes effect</p>
</blockquote>
<hr>
<h2 id="cors-max-age"><code>cors-max-age</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>600</code></li>
<li>Required: No</li>
<li>Default: Use browser/client default</li>
<li>Related: <code>cors-origins</code>, <code>cors-methods</code>, <code>cors-headers</code>, <code>cors-exposed-headers</code>, <code>cors-credentials</code></li>
</ul>
</div>

<p>This sets how long (in seconds) the results of a preflight request can be
cached for the request coming to gatekeeper. Sets the <code>Access-Control-Max-Age</code> header.</p>
<blockquote>
<p><code>cors-origins</code> has to be set before this configuration option takes effect</p>
</blockquote>
<hr>
<h2 id="cors-methods"><code>cors-methods</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>GET</code>, <code>POST</code></li>
<li>Required: No</li>
<li>Default: <code>[&quot;GET&quot;, &quot;POST&quot;, &quot;HEAD&quot;]</code></li>
<li>Related: <code>cors-origins</code>, <code>cors-headers</code>, <code>cors-exposed-headers</code>, <code>cors-credentials</code>, <code>cors-max-age</code></li>
</ul>
</div>

<p>This is a list of methods that will be added to the <code>Access-Control-Allow-Methods</code> header.</p>
<blockquote>
<p><code>cors-origins</code> has to be set before this configuration option takes effect</p>
</blockquote>
<hr>
<h2 id="cors-origins"><code>cors-origins</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>https://example.com</code></li>
<li>Required: No</li>
<li>Default: No CORS headers will be added</li>
<li>Related: <code>cors-methods</code>, <code>cors-headers</code>, <code>cors-exposed-headers</code>, <code>cors-credentials</code>, <code>cors-max-age</code></li>
</ul>
</div>

<p>This is a list of origins that will be added to the <code>Access-Control-Allow-Origin</code> header.</p>
<hr>
<h2 id="disable-all-logging"><code>disable-all-logging</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>true</code>, gatekeeper will not log to stdout or stderr.</p>
<hr>
<h2 id="discovery-url"><code>discovery-url</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_DISCOVERY_URL</code></li>
<li>Example: <code>https://keycloak.localhost/auth/realms/applications</code> (refer to <a href="https://github.com/gogatekeeper/demo-docker-compose">demo</a>)</li>
<li>Required: Yes, unless <code>skip-token-verification</code> is set, and gatekeeper is in reverse proxy mode</li>
<li>Default: None</li>
<li>Related: <code>skip-openid-provider-tls-verify</code>, <code>openid-provider-proxy</code>, <code>openid-provider-timeout</code></li>
</ul>
</div>

<p>gatekeeper will get information about the authorization server through the
authorization server&rsquo;s <code>openid-configuration</code> well-known URI, according to
<a href="https://tools.ietf.org/html/rfc8414">RFC8414</a>.</p>
<p>gatekeeper will grab this metadata from <code>discovery-url</code> + <code>/.well-known/openid-configuration</code>
as is registered with <a href="https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml">IANA</a></p>
<p>Specify <code>discovery-url</code> without <code>/.well-known/openid-configuration</code>.</p>
<p>Here are links to information about <code>discovery-url</code>s for some other OAuth providers</p>
<ul>
<li><a href="https://developers.google.com/identity/protocols/oauth2/openid-connect">Google Identity Platform</a></li>
<li><a href="https://auth0.com/docs/protocols/configure-applications-with-oidc-discovery">Auth0</a></li>
<li><a href="https://docs.identityserver.io/en/dev/endpoints/discovery.html">IdentityServer4</a></li>
<li><a href="https://docs.pingidentity.com/bundle/pingfederate-90/page/concept_openIdConnectMetadataEndpoint.html">PingFederate</a></li>
</ul>
<hr>
<h2 id="enable-authorization-cookies"><code>enable-authorization-cookies</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_ENABLE_AUTHORIZATION_COOKIES</code></li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If this is set, gatekeeper will add the authorization cookies to the upstream proxy request (containing access and refresh tokens).</p>
<hr>
<h2 id="enable-authorization-header"><code>enable-authorization-header</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_ENABLE_AUTHORIZATION_HEADER</code></li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If this is set, the access token will be added to the request going to the upstream service as the <code>Authorization</code> header:</p>
<pre><code>Authorization: Bearer &lt;access_token&gt;
</code></pre><hr>
<h2 id="enable-compression"><code>enable-compression</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Enables gzip compression for response from gatekeeper to browser.</p>
<hr>
<h2 id="enable-default-deny"><code>enable-default-deny</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: <code>resources</code></li>
</ul>
</div>

<p>Used in conjunction with <code>resources</code> for authorization.</p>
<p>If set, gatekeeper will deny all requests to the upstream by default. This can then be relaxed with definition of <code>resources</code>.</p>
<hr>
<h2 id="enable-encrypted-token"><code>enable-encrypted-token</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>force-encrypted-cookie</code>, <code>encryption-key</code></li>
</ul>
</div>

<p>If set, gatekeeper will</p>
<ul>
<li>Encrypt the access token in the cookie that is set for the browser with <code>encryption-key</code></li>
<li>Assume that incoming access tokens in the <code>Authorization</code> header are also
encrypted, and will decrypt the token before using it</li>
</ul>
<hr>
<h2 id="enable-forwarding"><code>enable-forwarding</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Sets gatekeeper in a forward proxy mode, for signing outbound requests. This is mutually exclusive with the default reverse proxy mode.</p>
<hr>
<h2 id="enable-https-redirect"><code>enable-https-redirect</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>enable-security-filter</code></li>
</ul>
</div>

<p>If this is set, gatekeeper will redirect all http requests to https.</p>
<p><code>enable-security-filter</code> has to be <code>true</code> for this to work.</p>
<hr>
<h2 id="enable-json-logging"><code>enable-json-logging</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If set, logging is formatted in json.</p>
<p>If the regular log is like this,</p>
<pre><code>2020-12-26T06:21:38.851Z        info    src/middleware.go:146   client request  {&quot;latency&quot;: 0.000209767, &quot;status&quot;: 303, &quot;bytes&quot;: 322, &quot;client_ip&quot;: &quot;172.18.0.2:39368&quot;, &quot;method&quot;: &quot;GET&quot;, &quot;path&quot;: &quot;/oauth/authorize&quot;}
</code></pre><p>the json version is like this.</p>
<pre><code>{&quot;level&quot;:&quot;info&quot;,&quot;ts&quot;:&quot;2020-12-26T06:21:38.851Z&quot;,&quot;caller&quot;:&quot;src/middleware.go:146&quot;,&quot;msg&quot;:&quot;client request&quot;,&quot;latency&quot;:0.000209767,&quot;status&quot;:303,&quot;bytes&quot;:322,&quot;client_ip&quot;:&quot;172.18.0.2:39368&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;path&quot;:&quot;/oauth/authorize&quot;}
</code></pre><hr>
<h2 id="enable-logging"><code>enable-logging</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If set, requests to gatekeeper are logged. Here&rsquo;s a sample of the information that is logged:</p>
<pre><code>2020-12-26T06:21:38.851Z        info    src/middleware.go:146   client request  {&quot;latency&quot;: 0.000209767, &quot;status&quot;: 303, &quot;bytes&quot;: 322, &quot;client_ip&quot;: &quot;172.18.0.2:39368&quot;, &quot;method&quot;: &quot;GET&quot;, &quot;path&quot;: &quot;/oauth/authorize&quot;}
</code></pre><p><code>raw path</code> is also logged if it is different from <code>path</code> and is not <code>&quot;&quot;</code>. See <a href="https://golang.org/pkg/net/url/">go docs</a> for the difference between <code>Path</code> and <code>RawPath</code>.</p>
<hr>
<h2 id="enable-login-handler"><code>enable-login-handler</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_ENABLE_LOGIN_HANDLER</code></li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If this is set, the login handler will be enabled.</p>
<p>By default, the login handler listens at <code>/oauth/login</code>, and looks for <code>username</code> and <code>password</code> in <code>POST</code> data from the browser. It will then obtain an access token and refresh token from the authorization server and then manage the tokens for the user.</p>
<hr>
<h2 id="enable-logout-redirect"><code>enable-logout-redirect</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>true</code>, when the logout address is accessed, the user will be redirected to the identity provider on logout, with a <code>redirect_uri</code> pointing back to the gatekeeper service.</p>
<p>The identity provider can use <code>redirect_uri</code> to redirect the user back to gatekeeper again.</p>
<p>If <code>false</code>, when the logout address is accessed, the user will remain at gatekeeper&rsquo;s logout url.</p>
<hr>
<h2 id="enable-metrics"><code>enable-metrics</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Setting this enables the prometheus metrics collector at <code>/oauth/metrics</code>. TODO add more information about metrics.</p>
<hr>
<h2 id="enable-profiling"><code>enable-profiling</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Setting this turns on profiling. TODO add more information about profiling.</p>
<hr>
<h2 id="enable-refresh-tokens"><code>enable-refresh-tokens</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_ENABLE_REFRESH_TOKEN</code></li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Set this to get gatekeeper to handle refreshing of access tokens. Otherwise, gatekeeper will just re-authenticate with the authorization server whenever the access token expires.</p>
<hr>
<h2 id="enable-security-filter"><code>enable-security-filter</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_ENABLE_SECURITY_FILTER</code></li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Enables a bunch of security checks on the request using middleware. TODO add more detail.</p>
<hr>
<h2 id="enable-session-cookies"><code>enable-session-cookies</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If this is set, gatekeeper will define the lifetime of the cookies (containing access and refresh tokens) to &ldquo;Session&rdquo;, indicting that they should be cleared when the browser closes.</p>
<p>The actual behavior, however, depends on how the browser is configured. Some browsers restore sessions when restarting, so session cookies might get restored. See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Define_the_lifetime_of_a_cookie">MDN: Lifetime of a cookie</a>.</p>
<p>If this is set to <code>false</code>, the cookies will be set to expire when the token expires.</p>
<hr>
<h2 id="enable-token-header"><code>enable-token-header</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If this is set, the access token will be added to the request going to the upstream service as the <code>X-Auth-Token</code> header.</p>
<hr>
<h2 id="enabled-proxy-protocol"><code>enabled-proxy-protocol</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Enables the <code>PROXY</code> protocol for gatekeeper, provided by
<a href="https://github.com/pires/go-proxyproto">proxyproto</a>. See more at
<a href="https://www.haproxy.org/download/2.3/doc/proxy-protocol.txt">https://www.haproxy.org/download/2.3/doc/proxy-protocol.txt</a></p>
<hr>
<h2 id="encryption-key"><code>encryption-key</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_ENCRYPTION_KEY</code></li>
<li>Example: <code>yb96KrChmqnEOHuIbBi650T7VDqyTwLZ</code></li>
<li>Required: Yes if <code>enable-refresh-tokens</code> is set</li>
<li>Default: None</li>
<li>Related: <code>encryption-key</code></li>
</ul>
</div>

<p><code>encryption-key</code> is used to encrypt the refresh token.</p>
<p>The <code>encryption-key</code> must be either 16 or 32 characters long. If it is 16
characters long, AES-128 will be selected. Otherwise, AES-256 will be selected.</p>
<hr>
<h2 id="filter-browser-xss"><code>filter-browser-xss</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>enable-security-filter</code></li>
</ul>
</div>

<p>Setting this adds the <code>X-XSS-Protection</code> header for the browser with <code>mode=block</code>. More information <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection">on MDN</a></p>
<p><code>enable-security-filter</code> has to be <code>true</code> to enable this.</p>
<hr>
<h2 id="filter-content-nosniff"><code>filter-content-nosniff</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>enable-security-filter</code></li>
</ul>
</div>

<p>Setting this adds the <code>X-Content-Type-Options</code> header for the browser with the value <code>nosniff</code>. More information <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">on MDN</a></p>
<p><code>enable-security-filter</code> has to be <code>true</code> to enable this.</p>
<hr>
<h2 id="filter-frame-deny"><code>filter-frame-deny</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>enable-security-filter</code></li>
</ul>
</div>

<p>Setting this adds the <code>X-Frame-Options</code> header with the value of <code>DENY</code>. More information <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">on MDN</a></p>
<p><code>enable-security-filter</code> has to be <code>true</code> to enable this.</p>
<hr>
<h2 id="forbidden-page"><code>forbidden-page</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>&quot;templates/forbidden.html.tmpl&quot;</code></li>
<li>Required: No</li>
<li>Default: No custom forbidden page</li>
<li>Related: <code>tags</code></li>
</ul>
</div>

<p>If <code>forbidden-page</code> is specified, gatekeeper will render this page and present
it to the user when the user is not authorized to view some resource.</p>
<p>The format for interpolating tags is the same as the one used in
<code>sign-in-page</code>. <code>tags</code> will also be used to render the forbidden page.</p>
<hr>
<h2 id="force-encrypted-cookie"><code>force-encrypted-cookie</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>enable-encrypted-token</code>, <code>encryption-key</code></li>
</ul>
</div>

<p>Same as <code>enable-encrypted-token</code>. TODO confirm this.</p>
<hr>
<h2 id="forwarding-domains"><code>forwarding-domains</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>example.com</code></li>
<li>Required: No</li>
<li>Default: Will add access token for any domains requested through gatekeeper.</li>
<li>Related: -</li>
</ul>
</div>

<p>If configured, gatekeeper will only add an access token (do authorization for)
to any request bound for any of the domains on this list. If not specified,
gatekeeper will do authorization for all domains.</p>
<p>Only used when gatekeeper is in forward proxy mode.</p>
<hr>
<h2 id="forwarding-password"><code>forwarding-password</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_FORWARDING_PASSWORD</code></li>
<li>Example: <code>password</code></li>
<li>Required: When gatekeeper is in forward proxy mode</li>
<li>Default: None</li>
<li>Related: <code>forwarding-username</code></li>
</ul>
</div>

<p>This is the password used for logging in to the Authorization Server (OAuth2
Resource Owner Password Credentials flow) when gatekeeper is in forward proxy
mode.</p>
<hr>
<h2 id="forwarding-username"><code>forwarding-username</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_FORWARDING_USERNAME</code></li>
<li>Example: <code>username</code></li>
<li>Required: When gatekeeper is in forward proxy mode</li>
<li>Default: None</li>
<li>Related: <code>forwarding-password</code></li>
</ul>
</div>

<p>This is the username used for logging in to the Authorization Server (OAuth2
Resource Owner Password Credentials flow) when gatekeeper is in forward proxy
mode.</p>
<hr>
<h2 id="headers"><code>headers</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example:</li>
</ul>
<pre><code>headers:
x-foo-bar: baz
</code></pre><ul>
<li>Required: No</li>
<li>Default: None</li>
<li>Related: -</li>
</ul>
</div>

<p>Add custom headers to the request that goes upstream. The headers will be capitalized:</p>
<pre><code>x-foo-bar =&gt; X-Foo-Bar
X-FooBar =&gt; X-Foobar
X-FOO-BAR =&gt; X-Foo-Bar
</code></pre><hr>
<h2 id="hostnames"><code>hostnames</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>service.com</code></li>
<li>Required: No</li>
<li>Default: <code>[]</code></li>
<li>Related: <code>use-letsencrypt</code>, <code>enable-security-filter</code></li>
</ul>
</div>

<p>If <code>hostnames</code> is set, gatekeeper will use this list of hostnames for the
security filter (if <code>enable-security-filter</code> is set) to only allow requests for
a hostname on this list of hostnames.</p>
<p><code>hostnames</code> is also used with <code>use-letsencrypt</code>. If set, the certificate
manager will only request certificates for the hostnames on the list. This can
be left unspecified, but will result in a LetsEncrypt certificate being
requested for any hostname for which gatekeeper is run on and may result in the
gatekeeper reaching the CA&rsquo;s rate limit.</p>
<hr>
<h2 id="http-only-cookie"><code>http-only-cookie</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If true, gatekeeper will set the <code>HttpOnly</code> attribute on the cookies used for access and refresh tokens.</p>
<p>If set, the cookies will only be sent to the server; they will be inaccessible to the JavaScript <code>Document.cookie</code> API: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Restrict_access_to_cookies:~:text=A%20cookie%20with%20the%20HttpOnly%20attribute%20is%20inaccessible%20to%20the%20JavaScript%20Document.cookie%20API">MDN</a>.</p>
<hr>
<h2 id="letsencrypt-cache-dir"><code>letsencrypt-cache-dir</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>/tmp/letsencrypt</code></li>
<li>Required: No</li>
<li>Default: <code>./cache/</code></li>
<li>Related: <code>use-letsencrypt</code></li>
</ul>
</div>

<p>This path is used to store cached Let&rsquo;s Encrypt certificates.</p>
<hr>
<h2 id="listen"><code>listen</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_LISTEN</code></li>
<li>Example: <code>:80</code></li>
<li>Required: Yes</li>
<li>Default: None</li>
<li>Related: <code>listen-http</code></li>
</ul>
</div>

<p><code>listen</code> configures the main listening interface (compare with <code>listen-http</code>). Examples for</p>
<ul>
<li>regular <code>http(s)</code>:</li>
<li>use <code>:80</code> or <code>:443</code> to listen on all interfaces</li>
<li><code>127.0.0.1:443</code> to only listen on a certain interface</li>
<li>unix socket: <code>unix:///tmp/echo.sock</code> (add the prefix <code>unix://</code>)</li>
</ul>

<div class="notices info" ><p>This config is passed to golang&rsquo;s <code>net.Listen()</code>, so use strings acceptable by <code>address</code>.</p>
</div>

<hr>
<h2 id="listen-http"><code>listen-http</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_LISTEN_HTTP</code></li>
<li>Example: <code>:80</code></li>
<li>Required: Yes</li>
<li>Default: None</li>
<li>Related: <code>listen</code></li>
</ul>
</div>

<p><code>listen-http</code> configures the secondary listening interface.
This listener has no TLS support, and uses the same configuration syntax as <code>listen</code>.</p>

<div class="notices info" ><p>Usually, we only use <code>listen</code> and not set <code>listen-http</code>.</p>
</div>

<hr>
<h2 id="localhost-metrics"><code>localhost-metrics</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Enforces that the metrics page can only been requested from the loopback interface, on <code>localhost</code>.</p>
<hr>
<h2 id="match-claims"><code>match-claims</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>aud=myapp</code>, <code>iss=http://example.*</code></li>
<li>Required: No</li>
<li>Default: No required claim matching</li>
<li>Related: -</li>
</ul>
</div>

<p>The proxy supports adding a variable list of claim matches against the
presented tokens for additional access control. You can match the <code>iss</code> or
<code>aud</code> to the token or custom attributes; each of the matches are regexes.</p>
<p>If <code>match-claims</code> is defined, the user&rsquo;s claims must match all of the requested
claims. You can configure this using the configuration file, like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">match-claims</span>:
<span style="color:#f92672">aud</span>: <span style="color:#ae81ff">openvpn</span>
<span style="color:#f92672">iss</span>: <span style="color:#ae81ff">https://keycloak.example.com/auth/realms/commons</span>
</code></pre></div><p>or via the CLI, like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--match-claims<span style="color:#f92672">=</span>aud<span style="color:#f92672">=</span>openvpn --match-claims<span style="color:#f92672">=</span>iss<span style="color:#f92672">=</span>https://keycloak.example.com/realms/commons
</code></pre></div><p>The above definition means that the user&rsquo;s token must</p>
<ul>
<li>contain both <code>aud</code> and <code>iss</code> claims AND</li>
<li><code>aud</code> must match <code>openvpn</code>, and <code>iss</code> must match <code>https://keycloak.example.com/realms/commons</code></li>
<li>so <code>foo_openvpn_bar</code> will match <code>openvpn</code></li>
<li>use a tighter regex <code>^openvpn$</code> to match <code>openvpn</code> strictly</li>
</ul>
<p>Another example: limitting the email domain permitted: if you want to limit to
only users on the <code>example.com</code> domain:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">match-claims</span>:
<span style="color:#f92672">email</span>: <span style="color:#ae81ff">^.*@example.com$</span>
</code></pre></div><p>The adapter supports matching on multi-value strings claims. The match
will succeed if ONE of the values matches, for example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">match-claims</span>:
<span style="color:#f92672">perms</span>: <span style="color:#ae81ff">perm1</span>
</code></pre></div><p>will successfully match</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
<span style="color:#f92672">&#34;iss&#34;</span>: <span style="color:#e6db74">&#34;https://sso.example.com&#34;</span>,
<span style="color:#f92672">&#34;sub&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
<span style="color:#f92672">&#34;perms&#34;</span>: [<span style="color:#e6db74">&#34;perm1&#34;</span>, <span style="color:#e6db74">&#34;perm2&#34;</span>]
}
</code></pre></div><hr>
<h2 id="max-idle-connections"><code>max-idle-connections</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>50</code></li>
<li>Required: No</li>
<li>Default: <code>100</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Maximum number of idle upstream/keycloak connections that gatekeeper will keep
alive.</p>
<hr>
<h2 id="max-idle-connections-per-host"><code>max-idle-connections-per-host</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>25</code></li>
<li>Required: No</li>
<li>Default: <code>50</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Maximum number of idle upstream/keycloak connections that gatekeeper will keep
alive, per host. <code>max-idle-connections-per-host</code> must be a number &gt; 0 and &lt;=
<code>max-idle-connections</code></p>
<hr>
<h2 id="no-redirects"><code>no-redirects</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>true</code>, gatekeeper will just return a <code>401 Unauthorized</code> instead of
redirecting the user to the authorization server.</p>
<hr>
<h2 id="oauth-uri"><code>oauth-uri</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_OAUTH_URI</code></li>
<li>Example: <code>/base-uri</code></li>
<li>Required: No</li>
<li>Default: <code>&quot;/oauth&quot;</code></li>
<li>Related: -</li>
</ul>
</div>

<p>This is the prefix for the OAuth endpoints on gatekeeper, such as (if the default <code>/oauth</code> is used, and <code>base-uri</code> is <code>&quot;&quot;</code>)</p>
<ul>
<li><code>/oauth/authorization</code>: Redirects to the authorization server</li>
<li><code>/oauth/callback</code>: Handles callback (response) from the authorization server</li>
<li><code>/oauth/expired</code>: Checks if the token has expired</li>
<li><code>/oauth/health</code>: The healthcheck endpoint for gatekeeper</li>
<li><code>/oauth/logout?redirect=url</code>: Direct the browser here to log out</li>
<li><code>/oauth/token</code>: Return the token in a json</li>
<li><code>/oauth/login</code>: A generic endpoint for clients to perform a user credentials
login to the authorization server</li>
</ul>
<hr>
<h2 id="oauth-uri-1"><code>oauth-uri</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_OAUTH_URI</code></li>
<li>Example: <code>/base-uri</code></li>
<li>Required: No</li>
<li>Default: <code>&quot;/oauth&quot;</code></li>
<li>Related: -</li>
</ul>
</div>

<p>This is the prefix for the OAuth endpoints on gatekeeper, such as (if the default <code>/oauth</code> is used, and <code>base-uri</code> is <code>&quot;&quot;</code>)</p>
<ul>
<li><code>/oauth/authorization</code>: Redirects to the authorization server</li>
<li><code>/oauth/callback</code>: Handles callback (response) from the authorization server</li>
<li><code>/oauth/expired</code>: Checks if the token has expired</li>
<li><code>/oauth/health</code>: The healthcheck endpoint for gatekeeper</li>
<li><code>/oauth/logout?redirect=url</code>: Direct the browser here to log out</li>
<li><code>/oauth/token</code>: Return the token in a json</li>
<li><code>/oauth/login</code>: A generic endpoint for clients to perform a user credentials
login to the authorization server</li>
</ul>
<hr>
<h2 id="openid-provider-proxy"><code>openid-provider-proxy</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>http://proxy.example.com:80</code></li>
<li>Required: No</li>
<li>Default: No proxy</li>
<li>Related: -</li>
</ul>
</div>

<p>Gatekeeper will use this proxy for requests to the OpenID provider, for example
to reach the discovery url, to get tokens, etc.</p>
<hr>
<h2 id="openid-provider-timeout"><code>openid-provider-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>30s</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Timeout for pulling OpenID configuration from the OpenID provider. Will be
parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a>.</p>
<hr>
<h2 id="preserve-host"><code>preserve-host</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>preserve-host</code> is <code>true</code>, the <code>Host</code> header that gatekeeper receives will be forwarded to the upstream service. Otherwise, the <code>Host</code> header will be set to whatever gatekeeper uses to make the request to the upstream.</p>
<hr>
<h2 id="redirection-url"><code>redirection-url</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_REDIRECTION_URL</code></li>
<li>Example: <code>932475b6-9748-41b8-8fd7-c6ce2d845ece</code> (refer to <a href="https://github.com/gogatekeeper/demo-docker-compose">demo</a>)</li>
<li>Required: Yes, unless <code>skip-token-verification</code> is set, and gatekeeper is in reverse proxy mode</li>
<li>Default: None</li>
<li>Related: <code>client-id</code></li>
</ul>
</div>

<p><code>client-secret</code> is the client secret for an OAuth2 client (your app is the
OAuth2 client, in this case). This is used with <code>client-id</code> as a pair of
credentials. See <code>client-id</code> for how this is used.</p>
<hr>
<h2 id="request-id-header"><code>request-id-header</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_REQUEST_ID_HEADER</code></li>
<li>Example: <code>&quot;X-Request-Id&quot;</code></li>
<li>Required: No</li>
<li>Default: <code>&quot;X-Request-Id&quot;</code></li>
<li>Related: <code>enable-request-id</code></li>
</ul>
</div>

<p>The HTTP header name for the autogenerated request ID sent as a header to the upstream service. Will be added if <code>enable-request-id</code> is set to true.</p>
<hr>
<h2 id="resources"><code>resources</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: Refer to <a href="https://github.com/gogatekeeper/demo-docker-compose">demo</a></li>
<li>Required: Yes</li>
<li>Default: None</li>
<li>Related: <code>enable-default-deny</code></li>
</ul>
</div>

<p>These tell gatekeeper how to authenticate or authorize the resources at the upstream.</p>
<p>Here&rsquo;s an example: (yaml config)</p>
<pre><code># Deny any access that is not allowlisted on the list of resources here
enable-default-deny: true

# Think of this as an allowlist
resources:
- uri: /admin/test
# Defines HTTP methods on the above uri that are allowed.
# If methods is not defined, gatekeeper allows all methods
methods:
- GET
# Defineds a list of roles the user must have in order to access the above uri
# If you only want authentication, don't define any roles
# gatekeeper will then check for the access token but not roles
roles:
- openvpn:vpn-user
- openvpn:prod-vpn
- test
- uri: /admin/*
# Wildcards are allowed!
methods:
- GET
roles:
- openvpn:vpn-user
- openvpn:commons-prod-vpn
</code></pre><p>If you wish to ensure all requests are authenticated you can use this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--resource<span style="color:#f92672">=</span>uri<span style="color:#f92672">=</span>/*
</code></pre></div><blockquote>
<p>Unless specified the method is assumed to be &lsquo;any|ANY&rsquo;</p>
</blockquote>
<p>The HTTP routing rules follow the guidelines from
<a href="https://github.com/go-chi/chi#router-design">chi</a>. The ordering of the
resources does not matter, the router will handle that for you.</p>
<hr>
<h2 id="revocation-url"><code>revocation-url</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_REVOCATION_URL</code></li>
<li>Example: <code>https://keycloak.localhost/auth/realms/applications/protocol/openid-connect/logout</code></li>
<li>Required: No. Will attempt to discover this url from OpenID discovery-url response</li>
<li>Default: None</li>
<li>Related: <code>discovery-url</code></li>
</ul>
</div>

<p>If <code>revocation-url</code> is not specified, the <code>end_session_endpoint</code> of the OpenID
discovery-url response will be used as the <code>revocation-url</code>. If neither is
available, no logout at the authorization provider will be done.</p>
<p><code>revocation-url</code> is used during the logout process. When the <code>/oauth/logout</code>
endpoint on gatekeeper is called, gatekeeper will request revocation of this
session&rsquo;s refresh token by doing an authenticated <code>POST</code> to this <code>revocation-url</code>
with the refresh token.</p>
<hr>
<h2 id="same-site-cookie"><code>same-site-cookie</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: Three options: <code>Strict</code>, <code>Lax</code>, <code>None</code> (case-sensitive)</li>
<li>Required: No</li>
<li>Default: <code>Lax</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Gatekeeper uses this config option to set the <code>SameSite</code> attribute on the cookies used for access and refresh tokens.</p>
<p>See more at <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#SameSite_attribute:~:text=SameSite%20attribute,-The">MDN</a></p>
<hr>
<h2 id="scopes"><code>scopes</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: (yaml/json list) <code>[&quot;offline&quot;, &quot;foobar&quot;]</code></li>
<li>Required: No</li>
<li>Default: Always appends these: <code>[&quot;openid&quot;, &quot;email&quot;, &quot;profile&quot;]</code></li>
<li>Related: -</li>
</ul>
</div>

<p>These are the scopes that are requested when the client is redirected to the authorization server.</p>
<p>In Keycloak, these are the scopes that are either created as part of the
client, to client scopes in the realm. For Keycloak, scopes are strings tagged
to mappers. If requested by the client, the associated mappers will be applied
on the tokens.</p>
<hr>
<h2 id="secure-cookie"><code>secure-cookie</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If true, gatekeeper will set the <code>Secure</code> attribute on the cookies used for access and refresh tokens.</p>
<p>If set, the cookies will only be sent to the server with an encrypted request over the HTTPS protocol: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#Restrict_access_to_cookies">MDN</a>.</p>
<hr>
<h2 id="server-idle-timeout"><code>server-idle-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>120s</code></li>
<li>Related: <code>server-read-timeout</code></li>
</ul>
</div>

<p>This sets the maximum time gatekeeper will wait for the next request when
keep-alives are enabled. If this is <code>0</code>, <code>server-read-timeout</code> is used. If
<code>server-read-timeout</code> is also <code>0</code>, there is no timeout.</p>
<hr>
<h2 id="server-read-timeout"><code>server-read-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>10s</code></li>
<li>Related: <code>server-idle-timeout</code></li>
</ul>
</div>

<p>This sets gatekeeper&rsquo;s maximum duration for reading the entire request from the
client, including the body.</p>
<hr>
<h2 id="server-write-timeout"><code>server-write-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>10s</code></li>
<li>Related: -</li>
</ul>
</div>

<p>This sets gatekeeper&rsquo;s maximum duration before timing out writes of the response.</p>
<hr>
<h2 id="sign-in-page"><code>sign-in-page</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>&quot;templates/sign_in.html.tmpl&quot;</code></li>
<li>Required: No</li>
<li>Default: No custom sign in page</li>
<li>Related: <code>tags</code></li>
</ul>
</div>

<p>By default, gatekeeper will immediately redirect users for
authentication. Specify <code>sign-in-page</code>, the path to a custom sign-in page
template, for gatekeeper will render this page and present it to the user. This
can be used as a landing page for your site, to guide users to sign in at the
authorization server.</p>
<p>The sign-in page will have a <code>redirect</code> variable passed into the scope, which
holds the OAuth redirection URL. Here&rsquo;s a sample custom sign-in page that you
can use.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">html</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ .redirect }}&#34;</span>&gt;Sign-in&lt;/<span style="color:#f92672">a</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>If you wish to pass additional variables into the templates, such as title,
sitename and so on, you can use the <code>--tags key=pair</code> option, like this:
<code>--tags title=&quot;This is my site&quot;</code> and the variable would be accessible from <code>{{ .title }}</code>.</p>
<hr>
<h2 id="skip-access-token-clientid-check"><code>skip-access-token-clientid-check</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>client-id</code></li>
</ul>
</div>

<p>If <code>true</code>, gatekeeper will not check that the configured <code>client-id</code> is among
the <code>aud</code> field of the access token.</p>
<hr>
<h2 id="skip-access-token-issuer-check"><code>skip-access-token-issuer-check</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>true</code>, gatekeeper will not check that <code>iss</code> in the access token matches the
issuer (Authorization server).</p>
<hr>
<h2 id="skip-openid-provider-tls-verify"><code>skip-openid-provider-tls-verify</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: false</li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>skip-openid-provider-tls-verify</code> is set to <code>true</code>, gatekeeper will skip
verification of the authorization server&rsquo;s (or OpenID provider&rsquo;s, in this case)
certificate chain and host name.</p>
<p>gatekeeper will accept any certificate presented by the server and any host name
in that certificate.</p>
<p>This flag is directly used to configure <code>InsecureSkipVerify</code> in <a href="https://golang.org/pkg/crypto/tls/">golang&rsquo;s tls
package</a>.</p>
<hr>
<h2 id="skip-token-verification"><code>skip-token-verification</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>true</code>, gatekeeper will only verify expiration and roles, but skip all other
token verification steps.</p>
<hr>
<h2 id="skip-upstream-tls-verify"><code>skip-upstream-tls-verify</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Specify this to skip TLS verification for upstream requests.</p>
<p>If <code>true</code>, gatekeeper will not verify the upstream&rsquo;s certificate chain and host
name; gatekeeper will accept any certificate presented by the server and any
host name in that certificate.</p>
<hr>
<h2 id="store-url"><code>store-url</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>redis://127.0.0.1:6379</code>, <code>boltdb:///tmp/tokens&quot;</code></li>
<li>Required: No</li>
<li>Default: Use a cookie for the refresh token</li>
<li>Related: <code>encryption-key</code></li>
</ul>
</div>

<p>This url must be a valid url. gatekeeper only supports redis and boltdb (bbolt)
for now.</p>
<p>If boltdb is used, the boltdb data snapshot file will be created at the
specified path.</p>
<p>This storage is used to store refresh tokens. If no storage is specified,
gatekeeper will store the refresh token, encrypted, in a cookie that is
returned to the client.</p>
<p>In all cases (redis, boltdb, or cookie), the refresh token is encrypted with
<code>encryption-key</code>.</p>
<hr>
<h2 id="tags"><code>tags</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>title=foobar</code></li>
<li>Required: No</li>
<li>Default: No tags for custom page rendering.</li>
<li>Related: <code>sign-in-page</code>, <code>forbidden-page</code></li>
</ul>
</div>

<p>The <code>tags</code> used when rendering the custom pages: <code>sign-in-page</code> and
<code>forbidden-page</code>.</p>
<hr>
<h2 id="tls-ca-certificate"><code>tls-ca-certificate</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>/path/to/tls/ca/certificate</code></li>
<li>Required: Required if <code>tls-ca-key</code> is specified</li>
<li>Default: Will handle requests using self-signed certificate from elazarl/goproxy</li>
<li>Related: <code>tls-ca-key</code></li>
</ul>
</div>

<p><code>tls-ca-certificate</code> is the path to a PEM encoded certificate file. This allows
gatekeeper to sign a TLS certificate for itself, using this
<code>tls-ca-certificate</code> and <code>tls-ca-key</code>.</p>
<p>Specify this to enforce mutual TLS: all clients connecting to gatekeeper must
present a certificate that was signed by the CA with <code>tls-ca-certificate</code>.</p>
<blockquote>
<p>TODO: verify if this CA cert/key only used for <code>CONNECT</code>?</p>
</blockquote>
<p>This path is not watched for changes, unlike for <code>tls-private-key</code> and
<code>tls-cert</code>.</p>
<hr>
<h2 id="tls-ca-key"><code>tls-ca-key</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>/path/to/tls/ca/key</code></li>
<li>Required: Required if <code>tls-ca-certificate</code> is specified</li>
<li>Default: Will handle requests using self-signed certificate from elazarl/goproxy</li>
<li>Related: <code>tls-ca-certificate</code></li>
</ul>
</div>

<p><code>tls-ca-key</code> is the path to a PEM encoded private key file. This allows
gatekeeper to sign a TLS certificate for itself, using this
<code>tls-ca-certificate</code> and <code>tls-ca-key</code>.</p>
<p>This path is not watched for changes, unlike for <code>tls-private-key</code> and
<code>tls-cert</code>.</p>
<hr>
<h2 id="tls-cert"><code>tls-cert</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>/path/to/tls/certificate</code></li>
<li>Required: Required if <code>tls-private-key</code> is specified</li>
<li>Default: No TLS configured for gatekeeper</li>
<li>Related: <code>tls-private-key</code></li>
</ul>
</div>

<p><code>tls-cert</code> is the path to the PEM encoded certificate file. This certificate
file may contain intermediate certificates following the leaf certificate to
form a certificate chain.</p>
<p>This certificate is served to clients connecting to gatekeeper, for both
forward and reverse proxy mode.</p>
<p>This path is watched for changes and gatekeeper will pick up new certificate
files.</p>
<p>No downtime is expected for certificate rotations. Clients who connected before
the certificate rotation will be unaffected and will continue as normal with
all new connections presented with the new certificate.</p>
<hr>
<h2 id="tls-client-certificate"><code>tls-client-certificate</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>/path/to/tls/client/certificate</code></li>
<li>Required: No</li>
<li>Default: No client certificates used for upstream connections</li>
<li>Related: -</li>
</ul>
</div>

<p>If <code>tls-client-ceritificate</code> is provided, this certificate will be used for
upstream connections, for both forward and reverse proxy modes.</p>
<p>This path is not watched for changes, unlike for <code>tls-private-key</code> and
<code>tls-cert</code>.</p>
<hr>
<h2 id="tls-private-key"><code>tls-private-key</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>/path/to/tls/private/key</code></li>
<li>Required: Required if <code>tls-cert</code> is specified</li>
<li>Default: No TLS configured for gatekeeper</li>
<li>Related: <code>tls-cert</code></li>
</ul>
</div>

<p><code>tls-private-key</code> is the path to the PEM encoded private key file.</p>
<p>This private key should be the private key for <code>tls-cert</code>.</p>
<p>This path is watched for changes and gatekeeper will pick up new private key
files.</p>
<hr>
<h2 id="upstream-ca"><code>upstream-ca</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>/tmp/path-to-ca-cert</code> (PEM encoded)</li>
<li>Required: No</li>
<li>Default: None (Will use system cert store)</li>
<li>Related: <code>upstream-url</code></li>
</ul>
</div>

<p>This is the TLS CA certificate that will be used to verify TLS when communicating with the upstream.</p>
<hr>
<h2 id="upstream-expect-continue-timeout"><code>upstream-expect-continue-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>10s</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Maximum amount of time that gatekeeper will wait for the upstream&rsquo;s first
response headers after fully writing the request headers if the request has an
&ldquo;Expect: 100-continue&rdquo; header.</p>
<hr>
<h2 id="upstream-keepalive-timeout"><code>upstream-keepalive-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>10s</code></li>
<li>Related: <code>upstream-keepalives</code></li>
</ul>
</div>

<p>The interval between keep-alive probes for an active network connection.</p>
<hr>
<h2 id="upstream-keepalives"><code>upstream-keepalives</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>true</code></li>
<li>Related: <code>upstream-keepalive-timeout</code></li>
</ul>
</div>

<p>If <code>true</code> (the default), gatekeeper will use HTTP keep-alives when
communicating with the upstream.</p>
<hr>
<h2 id="upstream-response-header-timeout"><code>upstream-response-header-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>10s</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Maximum amount of time that gatekeeper will wait for the upstream&rsquo;s response
headers after fully writing the request.</p>
<hr>
<h2 id="upstream-timeout"><code>upstream-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>10s</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Maximum amount of time that gatekeeper will wait to connect to the upstream.</p>
<hr>
<h2 id="upstream-tls-handshake-timeout"><code>upstream-tls-handshake-timeout</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>3s</code>, or <code>314ms</code>, (any string that can be parsed by <a href="https://golang.org/pkg/time/#ParseDuration">ParseDuration</a></li>
<li>Required: No</li>
<li>Default: <code>10s</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Maximum amount of time that gatekeeper will wait for a TLS handshake.</p>
<hr>
<h2 id="upstream-url"><code>upstream-url</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: <code>PROXY_UPSTREAM_URL</code></li>
<li>Example: <code>http://whoami:80</code> (refer to <a href="https://github.com/gogatekeeper/demo-docker-compose">demo</a>)</li>
<li>Required: Yes</li>
<li>Default: None</li>
<li>Related: <code>upstream-ca</code></li>
</ul>
</div>

<p>This tells gatekeeper how to contact the upstream (your app/service that is protected by gatekeeper)</p>
<hr>
<h2 id="use-letsencrypt"><code>use-letsencrypt</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: <code>letsencrypt-cache-dir</code></li>
</ul>
</div>

<p>If <code>true</code>, gatekeeper will request a certificate from Let&rsquo;s Encrypt.</p>
<hr>
<h2 id="verbose"><code>verbose</code></h2>

<div class="config-details"><ul>
<li>Environment Variable: None</li>
<li>Example: <code>true</code> or <code>false</code></li>
<li>Required: No</li>
<li>Default: <code>false</code></li>
<li>Related: -</li>
</ul>
</div>

<p>Set <code>verbose</code> to <code>true</code> to turn on debug/verbose logging.</p>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1612416408"></script>
    <script src="/js/perfect-scrollbar.min.js?1612416408"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1612416408"></script>
    <script src="/js/jquery.sticky.js?1612416408"></script>
    <script src="/js/featherlight.min.js?1612416408"></script>
    <script src="/js/highlight.pack.js?1612416408"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1612416408"></script>
    <script src="/js/learn.js?1612416408"></script>
    <script src="/js/hugo-learn.js?1612416408"></script>
    
        
            <script src="/mermaid/mermaid.js?1612416408"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
